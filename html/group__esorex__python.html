<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESO Recipe Execution Tool: Python Interfacing Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ESO Recipe Execution Tool
   &#160;<span id="projectnumber">3.13.5</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Python Interfacing Functions</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga11a85d88580e077cf306d61230bef095"><td class="memItemLeft" align="right" valign="top">cpl_error_code&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__esorex__python.html#ga11a85d88580e077cf306d61230bef095">er_python_load_modules</a> (<a class="el" href="structer__stringarray__t.html">er_stringarray_t</a> *paths)</td></tr>
<tr class="memdesc:ga11a85d88580e077cf306d61230bef095"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads relevant information for Python modules that contain plugins.  <a href="group__esorex__python.html#ga11a85d88580e077cf306d61230bef095">More...</a><br /></td></tr>
<tr class="separator:ga11a85d88580e077cf306d61230bef095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0f59988880739bf49ef02d82c882c38f"><td class="memItemLeft" align="right" valign="top">cpl_error_code&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__esorex__python.html#ga0f59988880739bf49ef02d82c882c38f">er_python_select_module</a> (const char *module_name)</td></tr>
<tr class="memdesc:ga0f59988880739bf49ef02d82c882c38f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Selects a specific Python module to use for execution.  <a href="group__esorex__python.html#ga0f59988880739bf49ef02d82c882c38f">More...</a><br /></td></tr>
<tr class="separator:ga0f59988880739bf49ef02d82c882c38f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga74d0c3d33489db2e3ea3d3eddd4954b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__esorex__python.html#ga74d0c3d33489db2e3ea3d3eddd4954b5">er_python_get_plugin_list</a> (cpl_pluginlist *list)</td></tr>
<tr class="memdesc:ga74d0c3d33489db2e3ea3d3eddd4954b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills a list with all available plugins for a selected Python module.  <a href="group__esorex__python.html#ga74d0c3d33489db2e3ea3d3eddd4954b5">More...</a><br /></td></tr>
<tr class="separator:ga74d0c3d33489db2e3ea3d3eddd4954b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae32f4167555da0ed5335756f7ce45619"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__esorex__python.html#gae32f4167555da0ed5335756f7ce45619">er_python_cleanup</a> (void)</td></tr>
<tr class="memdesc:gae32f4167555da0ed5335756f7ce45619"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets loaded Python module information.  <a href="group__esorex__python.html#gae32f4167555da0ed5335756f7ce45619">More...</a><br /></td></tr>
<tr class="separator:gae32f4167555da0ed5335756f7ce45619"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This module provides functions needed to interface with a Python interpreter running as an external process that will execute a Python based plugin. The CPL plugin API is preserved as much as possible, both on the EsoRex side and within the Python plugin code. Thus, the EsoRex core code will invoke the Python based plugin through the usual calls to the <code>cpl_plugin</code> class (more specifically, derived classes such as <code>cpl_recipe</code>). This module provides the mechanism to load Python modules, identify the Python based plugins, select the desired module, and then actually perform the necessary communication with the Python interpreter to execute the plugin.</p>
<p>The exported functions of this interface deal with the differences in loading Python module plugins versus C/C++ based shared library plugins. Only the loading and unloading needs special treatment from EsoRex, since the actual invocation of the plugin is through the usual <code>cpl_plugin</code> API. Thus, starting/stopping the Python interpreter and the communication protocol is all hidden behind the interface from EsoRex's point of view inside the private functions of this module.</p>
<p>Loading of a Python module involves starting the Python interpreter, loading the named Python module file and finding all Python classes that derive from a class called <code>CplPlugin</code>. This is accomplished with the function <a class="el" href="group__esorex__python.html#ga11a85d88580e077cf306d61230bef095" title="Loads relevant information for Python modules that contain plugins.">er_python_load_modules()</a>. All such classes are registered and can be subsequently selected with <a class="el" href="group__esorex__python.html#ga0f59988880739bf49ef02d82c882c38f" title="Selects a specific Python module to use for execution.">er_python_select_module()</a>. Selecting the desired module is necessary, so that <a class="el" href="group__esorex__python.html#ga74d0c3d33489db2e3ea3d3eddd4954b5" title="Fills a list with all available plugins for a selected Python module.">er_python_get_plugin_list()</a> knows for which Python module to return the list of available plugins. The function <a class="el" href="group__esorex__python.html#ga74d0c3d33489db2e3ea3d3eddd4954b5" title="Fills a list with all available plugins for a selected Python module.">er_python_get_plugin_list()</a> can be considered as the equivalent of the <code>cpl_plugin_get_info()</code> entry point function that must be implemented by a C/C++ based shared library plugin. Once <a class="el" href="group__esorex__python.html#ga74d0c3d33489db2e3ea3d3eddd4954b5" title="Fills a list with all available plugins for a selected Python module.">er_python_get_plugin_list()</a> has successfully returned a list of CPL plugin objects, there is no difference in the invocation procedure to execute the plugin between a Python module or shared library based plugin. Once the invocation of the plugin is complete, one must cleanup by calling the <a class="el" href="group__esorex__python.html#gae32f4167555da0ed5335756f7ce45619" title="Resets loaded Python module information.">er_python_cleanup()</a> function. A simple code example for the call sequence to invoke a Python based plugin will look as follows (error handling is ignored for simplicity): </p><div class="fragment"><div class="line"><a class="code" href="structer__stringarray__t.html">er_stringarray_t</a> * modules = <a class="code" href="group__er__stringarray.html#ga86b8aa4b5c6972b06a92da3eb8c0cdbc">er_stringarray_new</a>();</div>
<div class="line">cpl_pluginlist * list = cpl_pluginlist_new();</div>
<div class="line">cpl_plugin_func plugin_init, plugin_exec, plugin_deinit;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Python specific module initialisation.</span></div>
<div class="line"><a class="code" href="group__er__stringarray.html#ga3df1fcc174cbc0dc28804ca1b24fbfec">er_stringarray_append</a>(modules, <span class="stringliteral">&quot;./recipe.py&quot;</span>);</div>
<div class="line"><a class="code" href="group__esorex__python.html#ga11a85d88580e077cf306d61230bef095">er_python_load_modules</a>(modules);</div>
<div class="line"><a class="code" href="group__esorex__python.html#ga0f59988880739bf49ef02d82c882c38f">er_python_select_module</a>(<span class="stringliteral">&quot;./recipe.py&quot;</span>);</div>
<div class="line"><a class="code" href="group__esorex__python.html#ga74d0c3d33489db2e3ea3d3eddd4954b5">er_python_get_plugin_list</a>(list);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Common plugin invocation sequence.</span></div>
<div class="line">cpl_recipe * recipe = (cpl_recipe *) cpl_calloc(1, <span class="keyword">sizeof</span>(cpl_recipe));</div>
<div class="line">recipe-&gt;frames = cpl_frameset_new();</div>
<div class="line">plugin_init = cpl_plugin_get_init(&amp;recipe-&gt;interface);</div>
<div class="line"><span class="keywordflow">if</span> (plugin_init != NULL) {</div>
<div class="line">  plugin_init(&amp;recipe-&gt;interface);</div>
<div class="line">}</div>
<div class="line">plugin_exec = cpl_plugin_get_exec(&amp;recipe-&gt;interface);</div>
<div class="line"><span class="keywordflow">if</span> (plugin_exec != NULL) {</div>
<div class="line">  plugin_exec(&amp;recipe-&gt;interface);</div>
<div class="line">}</div>
<div class="line">plugin_deinit = cpl_plugin_get_deinit(&amp;recipe-&gt;interface);</div>
<div class="line"><span class="keywordflow">if</span> (plugin_deinit != NULL) {</div>
<div class="line">  plugin_deinit(&amp;recipe-&gt;interface);</div>
<div class="line">}</div>
<div class="line">cpl_frameset_delete(recipe-&gt;frames);</div>
<div class="line">cpl_plugin_delete(&amp;recipe-&gt;interface);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Python specific cleanup.</span></div>
<div class="line"><a class="code" href="group__esorex__python.html#gae32f4167555da0ed5335756f7ce45619">er_python_cleanup</a>();</div>
</div><!-- fragment --><p>Under the hood, communication with the Python interpreter is handled by the <code>execute</code> function, which is registered with the <code>cpl_plugin</code> objects returned by <a class="el" href="group__esorex__python.html#ga74d0c3d33489db2e3ea3d3eddd4954b5" title="Fills a list with all available plugins for a selected Python module.">er_python_get_plugin_list()</a>. The communication protocol uses JSON as the exchange format that is sent over Unix pipes. The <code>execute</code> function is a stub that will implement the following steps: </p><ol>
<li>
Start an external Python interpreter process with the <code>python</code> shell command and give it the initial Python stub code to execute.  </li>
<li>
Encode the input <code>cpl_plugin</code> structure as JSON format.  </li>
<li>
Send the JSON text to the Python interpreter over a Unix pipe.  </li>
<li>
Close the input pipe to indicate end of input.  </li>
<li>
Read the output from a second pipe, to which the Python process will write the results in JSON format.  </li>
<li>
Wait for the output pipe to be closed, which indicates end of output.  </li>
<li>
Decode the output JSON text back into a <code>cpl_plugin</code> structure and update the <code>cpl_plugin</code> argument of the <code>execute</code> function.  </li>
<li>
Wait for the Python interpreter to terminate (join with the process).  </li>
<li>
Return the plugin's return code received from the Python plugin.  </li>
</ol>
<p>The other end of the protocol is implemented in the initial Python stub code passed to the Python interpreter to execute. The steps it will perform are: </p><ol>
<li>
Import the desired Python module containing the plugin.  </li>
<li>
Instantiate the selected plugin object (a class that derives from <code>CplPlugin</code>).  </li>
<li>
Read the JSON input from the Unix pipe.  </li>
<li>
Wait for the input pipe to be closed, which indicates the end of input.  </li>
<li>
Decode the JSON into a Python object.  </li>
<li>
Call the plugin object's <code>execute</code> method, passing the decoded Python object as the method's argument.  </li>
<li>
Once the Python <code>execute</code> method completes, the updated argument and return value are encoded as JSON again.  </li>
<li>
The encoded JSON result is send over the output pipe.  </li>
<li>
The output pipe is closed to indicate the end of output.  </li>
<li>
The Python interpreter ends execution and terminates.  </li>
</ol>
<p>Note that the JSON is not send over the stdin and stdout pipes, but rather two new dedicated pipes are created to handle the interprocess communication. This allows the stdin and stdout pipes to behave as one would normally expect. For example, they will be attached to the same terminal or file as the parent process (i.e. EsoRex) was attached to. This means that print statements in the Python code will write the output to the same location as one would expect if the Python code was executed manually in the Python interpreter. Separation of the EsoRex to Python communication protocol from stdin/stdout avoids unexpected interference or having stdin/stdout redirected in an unexpected manner.</p>
<p>Developers of Python based plugins must implement a plugin class that has the following requirements: </p><ul>
<li>
Must derive from a class called <code>CplPlugin</code> or it must itself be called <code>CplPlugin</code>.  </li>
<li>
The <code>__init__</code> constructor must take no arguments or all arguments must have defaults.  </li>
<li>
The following class attributes must be defined (unless indicated as optional) or set in the <code>__init__</code> function: <dl>
<dt>name </dt>
<dd>Name of the plugin/recipe. If not given then the Python class's name is used instead. (type <code>basestring</code>, optional) </dd>
<dt>version </dt>
<dd>The version number of the plugin. (type <code>int</code>) </dd>
<dt>synopsis </dt>
<dd>A summary text giving a brief description of the plugin. If not given then the first line of the doc string for the class is used instead. (type <code>basestring</code>, optional)  </dd>
<dt>description </dt>
<dd>A description text for the plugin. If not given then the doc string for the class is used instead. (type <code>basestring</code>, optional)  </dd>
<dt>author </dt>
<dd>The author of the plugin. An empty string is used if not given. (type <code>basestring</code>, optional) </dd>
<dt>email </dt>
<dd>The email address of plugin's author. An empty string is used if not given. (type <code>basestring</code>, optional) </dd>
<dt>copyright </dt>
<dd>The copyright notice for the plugin. An empty string is used if not given. (type <code>basestring</code>, optional) </dd>
<dt>parameters </dt>
<dd>A list of input parameters accepted by the plugin (type <code>list</code>, optional). This must be a list of dictionaries with the following keys:  <dl>
<dt>class </dt>
<dd>The type of parameter. Must be one of <code>'value'</code>, <code>'range'</code> or <code>'enum'</code>. (type <code>basestring</code>) </dd>
<dt>name </dt>
<dd>The name of the parameter. (type <code>basestring</code>) </dd>
<dt>default </dt>
<dd>The default value of the parameter if no value is assigned. (type can be one of <code>bool</code>, <code>int</code>, <code>float</code> or <code>basestring</code>) </dd>
<dt>min </dt>
<dd>The minimum allowed value of the range. This only needs to be set if <em>class</em> is <code>'range'</code>. (type <code>int</code> or <code>float</code>, but <em>default</em> must have the same matching type) </dd>
<dt>max </dt>
<dd>The maximum allowed value of the range. This only needs to be set if <em>class</em> is <code>'range'</code>. (type <code>int</code> or <code>float</code>, but <em>default</em> must have the same matching type) </dd>
<dt>choices </dt>
<dd>The list of allowed values. This only needs to be set if <em>class</em> is <code>'enum'</code>. The individual elements in the list can be one of <code>int</code>, <code>float</code> or <code>basestring</code>; but must all have the same type and must match the type used for <em>default</em>. (type <code>list</code>) </dd>
<dt>description </dt>
<dd>Text describing the parameter. (type <code>basestring</code>, optional) </dd>
<dt>context </dt>
<dd>The application context for the parameter, typically the plugin name. (type <code>basestring</code>, optional) </dd>
<dt>tag </dt>
<dd>A free form tag associated with a parameter. (type <code>basestring</code>, optional) </dd>
<dt>cli_enabled </dt>
<dd>Flag indicating if the parameter is available on the EsoRex command line. (type <code>bool</code>, optional) </dd>
<dt>cli_alias </dt>
<dd>The name of the parameter when given on the EsoRex command line. If not set then the full parameter name is used. (type <code>basestring</code>, optional) </dd>
<dt>env_enabled </dt>
<dd>Flag indicating if the parameter can be set as an environment variable. (type <code>bool</code>, optional) </dd>
<dt>env_alias </dt>
<dd>The name of the environment variable to use as this parameter. If not set then the full parameter name is used as the environment variable. (type <code>basestring</code>, optional) </dd>
<dt>cfg_enabled </dt>
<dd>Flag indicating if the parameter can be set from a configuration file. (type <code>bool</code>, optional) </dd>
<dt>cfg_alias </dt>
<dd>The name of the parameter to use in the configuration file. If not set then the full parameter name is used. (type <code>basestring</code>, optional) </dd>
</dl>
</dd>
<dt>recipeconfig </dt>
<dd>A list of frame tags and their associations to input and output frames. (type <code>list</code>, optional). This must be a list of dictionaries with the following keys:  <dl>
<dt>tag </dt>
<dd>The frame's tag value, typically the tag used in the Set-of-Frames. (type <code>basestring</code>) </dd>
<dt>min </dt>
<dd>The minimum number of frames of type <em>tag</em>. (type <code>int</code>) </dd>
<dt>max </dt>
<dd>The maximum number of frames of type <em>tag</em>. (type <code>int</code>) </dd>
<dt>inputs </dt>
<dd>The input frames associated with the frame of type <em>tag</em> (type <code>list</code>). This must be a list of dictionaries with the following keys: <dl>
<dt>tag </dt>
<dd>The input frame's tag value. (type <code>basestring</code>) </dd>
<dt>min </dt>
<dd>The minimum number of associated input frames. (type <code>int</code>) </dd>
<dt>max </dt>
<dd>The maximum number of associated input frames. (type <code>int</code>) </dd>
</dl>
</dd>
<dt>outputs </dt>
<dd>The output frames associated with the frame of type <em>tag</em>. (type <code>list</code> of <code>basestring</code> elements) </dd>
</dl>
</dd>
</dl>
</li>
<li>
<p class="startli">Must have a method called <code>execute</code> defined as follows: </p><pre class="fragment">def execute(self, plugin):
</pre><p class="interli">It will take a single dictionary argument <em>plugin</em> and return an integer return code. <code>0</code> will indicate success and any other value will indicate an error. If an error does occur, the <code>execute</code> method should assign an appropriate string message to the attribute <code>self.error_message</code>.</p>
<p class="endli">Input parameters can be accessed as <code>plugin</code>['parameters']. Input frames are accessed as <code>plugin</code>['frames']. Any new output frames must be appended to the <code>plugin</code>['frames'] list.  </p>
</li>
</ul>
<p>The following is a simple example of a Python class that implements the required interface: </p><div class="fragment"><div class="line">class CplPlugin(object):</div>
<div class="line">    name = <span class="stringliteral">&quot;test&quot;</span></div>
<div class="line">    version = 102030</div>
<div class="line">    synopsis = <span class="stringliteral">&quot;short description&quot;</span></div>
<div class="line">    description = <span class="stringliteral">&quot;long description&quot;</span></div>
<div class="line">    author = <span class="stringliteral">&quot;Some Author&quot;</span></div>
<div class="line">    email = <span class="stringliteral">&quot;someone@example.org&quot;</span></div>
<div class="line">    copyright = <span class="stringliteral">&quot;copyright 2017&quot;</span></div>
<div class="line">    parameters = [</div>
<div class="line">        {</div>
<div class="line">            <span class="stringliteral">&#39;class&#39;</span>: <span class="stringliteral">&#39;value&#39;</span>,</div>
<div class="line">            <span class="stringliteral">&#39;name&#39;</span>: <span class="stringliteral">&#39;test.par1&#39;</span>,</div>
<div class="line">            <span class="stringliteral">&#39;description&#39;</span>: <span class="stringliteral">&#39;parameter 1&#39;</span>,</div>
<div class="line">            <span class="stringliteral">&#39;context&#39;</span>: <span class="stringliteral">&#39;test&#39;</span>,</div>
<div class="line">            <span class="stringliteral">&#39;default&#39;</span>: 3</div>
<div class="line">        }</div>
<div class="line">    ]</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>execute(self, plugin):</div>
<div class="line">        <span class="comment"># Fetch the parameter value.</span></div>
<div class="line">        parameters = plugin[<span class="stringliteral">&#39;parameters&#39;</span>]</div>
<div class="line">        par1 = <span class="keywordtype">None</span></div>
<div class="line">        <span class="keywordflow">for</span> par <span class="keywordflow">in</span> parameters:</div>
<div class="line">            <span class="keywordflow">if</span> par[<span class="stringliteral">&#39;name&#39;</span>] == <span class="stringliteral">&#39;par1&#39;</span>:</div>
<div class="line">                par1 = par[<span class="stringliteral">&#39;value&#39;</span>]</div>
<div class="line"> </div>
<div class="line">        <span class="comment"># Fetch the first frame&#39;s file name.</span></div>
<div class="line">        frames = plugin[<span class="stringliteral">&#39;frames&#39;</span>]</div>
<div class="line">        filename = frames[0][<span class="stringliteral">&#39;filename&#39;</span>]</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">try</span>:</div>
<div class="line">            <span class="comment"># ... process frames ...</span></div>
<div class="line">        <span class="keywordflow">except</span>:</div>
<div class="line">            <span class="comment"># Set the error message and indicate an error.</span></div>
<div class="line">            self.error_message = <span class="stringliteral">&quot;Recipe failed&quot;</span></div>
<div class="line">            <span class="keywordflow">return</span> 1</div>
<div class="line"> </div>
<div class="line">        <span class="comment"># Append new frames as output.</span></div>
<div class="line">        frames.append(</div>
<div class="line">            {</div>
<div class="line">                <span class="stringliteral">&#39;filename&#39;</span>: <span class="stringliteral">&#39;output.fits&#39;</span>,</div>
<div class="line">                <span class="stringliteral">&#39;tag&#39;</span>: <span class="stringliteral">&#39;PROD&#39;</span>,</div>
<div class="line">                <span class="stringliteral">&#39;type&#39;</span>: 2,</div>
<div class="line">                <span class="stringliteral">&#39;group&#39;</span>: 3,</div>
<div class="line">                <span class="stringliteral">&#39;level&#39;</span>: 3,</div>
<div class="line">            }</div>
<div class="line">        )</div>
<div class="line"> </div>
<div class="line">        <span class="comment"># Indicate success.</span></div>
<div class="line">        <span class="keywordflow">return</span> 0</div>
</div><!-- fragment --> <h2 class="groupheader">Function Documentation</h2>
<a id="gae32f4167555da0ed5335756f7ce45619"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae32f4167555da0ed5335756f7ce45619">&#9670;&nbsp;</a></span>er_python_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void er_python_cleanup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets loaded Python module information. </p>
<p>This function should be called when one no longer needs to deal with any Python based plugins. </p>

</div>
</div>
<a id="ga74d0c3d33489db2e3ea3d3eddd4954b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga74d0c3d33489db2e3ea3d3eddd4954b5">&#9670;&nbsp;</a></span>er_python_get_plugin_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int er_python_get_plugin_list </td>
          <td>(</td>
          <td class="paramtype">cpl_pluginlist *&#160;</td>
          <td class="paramname"><em>list</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills a list with all available plugins for a selected Python module. </p>
<p>This function is the equivalent of the <code>cpl_plugin_get_info()</code> function found in a compiled plugin library. It will fill a list of CPL plugin objects for all plugins found in the currently selected Python module. <a class="el" href="group__esorex__python.html#ga0f59988880739bf49ef02d82c882c38f" title="Selects a specific Python module to use for execution.">er_python_select_module()</a> must be called before this function is invoked.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">list</td><td>The plugin list that will be filled with CPL plugin objects.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> is returned on success and an appropriate CPL error code otherwise. </dd></dl>

</div>
</div>
<a id="ga11a85d88580e077cf306d61230bef095"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga11a85d88580e077cf306d61230bef095">&#9670;&nbsp;</a></span>er_python_load_modules()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cpl_error_code er_python_load_modules </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structer__stringarray__t.html">er_stringarray_t</a> *&#160;</td>
          <td class="paramname"><em>paths</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads relevant information for Python modules that contain plugins. </p>
<p>This function will go through a list of module paths that point to Python code files and attempt to load these. If the module can be loaded successfully and it contains any classes that derive from a base class called <code>CplPlugin</code> (including <code>CplPlugin</code> itself) then these are recorded, such that <a class="el" href="group__esorex__python.html#ga0f59988880739bf49ef02d82c882c38f" title="Selects a specific Python module to use for execution.">er_python_select_module()</a> can then be used to select a particular Python module to run. Only classes directly within the Python module's namespace are considered, i.e. secondary imported modules will not have their classes added unless they are imported into the namespace with a "<code>from ... import ...</code>" Python statement.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">paths</td><td>The list of module paths that need to be checked if they can be loaded. Any paths that do not contain loadable plugins will be removed from the list by this function.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>CPL_ERROR_NONE</code> on success and an appropriate error code if a severe error occurred.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function will still succeed if a Python module could not be loaded. All such modules are simply ignored. However, the user may get error messages printed by the Python process on stderr. </dd></dl>

</div>
</div>
<a id="ga0f59988880739bf49ef02d82c882c38f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0f59988880739bf49ef02d82c882c38f">&#9670;&nbsp;</a></span>er_python_select_module()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cpl_error_code er_python_select_module </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>module_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Selects a specific Python module to use for execution. </p>
<p>This function is used to select the Python module that will be used when the <a class="el" href="group__esorex__python.html#ga74d0c3d33489db2e3ea3d3eddd4954b5" title="Fills a list with all available plugins for a selected Python module.">er_python_get_plugin_list()</a> function is invoked and attempts to load all available plugin classes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">module_name</td><td>The full path name of the python module to use.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>CPL_ERROR_NONE</code> on success or an appropriate error code if a severe error occurs. </dd></dl>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="agroup__esorex__python_html_ga74d0c3d33489db2e3ea3d3eddd4954b5"><div class="ttname"><a href="group__esorex__python.html#ga74d0c3d33489db2e3ea3d3eddd4954b5">er_python_get_plugin_list</a></div><div class="ttdeci">int er_python_get_plugin_list(cpl_pluginlist *list)</div><div class="ttdoc">Fills a list with all available plugins for a selected Python module.</div><div class="ttdef"><b>Definition:</b> er_python.c:2109</div></div>
<div class="ttc" id="agroup__esorex__python_html_ga11a85d88580e077cf306d61230bef095"><div class="ttname"><a href="group__esorex__python.html#ga11a85d88580e077cf306d61230bef095">er_python_load_modules</a></div><div class="ttdeci">cpl_error_code er_python_load_modules(er_stringarray_t *paths)</div><div class="ttdoc">Loads relevant information for Python modules that contain plugins.</div><div class="ttdef"><b>Definition:</b> er_python.c:1028</div></div>
<div class="ttc" id="agroup__er__stringarray_html_ga86b8aa4b5c6972b06a92da3eb8c0cdbc"><div class="ttname"><a href="group__er__stringarray.html#ga86b8aa4b5c6972b06a92da3eb8c0cdbc">er_stringarray_new</a></div><div class="ttdeci">er_stringarray_t * er_stringarray_new(void)</div><div class="ttdoc">Creates a new er_stringarray.</div><div class="ttdef"><b>Definition:</b> er_stringarray.c:62</div></div>
<div class="ttc" id="agroup__er__stringarray_html_ga3df1fcc174cbc0dc28804ca1b24fbfec"><div class="ttname"><a href="group__er__stringarray.html#ga3df1fcc174cbc0dc28804ca1b24fbfec">er_stringarray_append</a></div><div class="ttdeci">void er_stringarray_append(er_stringarray_t *csa, const char *instring)</div><div class="ttdoc">Adds a copy to given string at end of stringarray.</div><div class="ttdef"><b>Definition:</b> er_stringarray.c:254</div></div>
<div class="ttc" id="agroup__esorex__python_html_ga0f59988880739bf49ef02d82c882c38f"><div class="ttname"><a href="group__esorex__python.html#ga0f59988880739bf49ef02d82c882c38f">er_python_select_module</a></div><div class="ttdeci">cpl_error_code er_python_select_module(const char *module_name)</div><div class="ttdoc">Selects a specific Python module to use for execution.</div><div class="ttdef"><b>Definition:</b> er_python.c:1271</div></div>
<div class="ttc" id="agroup__esorex__python_html_gae32f4167555da0ed5335756f7ce45619"><div class="ttname"><a href="group__esorex__python.html#gae32f4167555da0ed5335756f7ce45619">er_python_cleanup</a></div><div class="ttdeci">void er_python_cleanup(void)</div><div class="ttdoc">Resets loaded Python module information.</div><div class="ttdef"><b>Definition:</b> er_python.c:2174</div></div>
<div class="ttc" id="astructer__stringarray__t_html"><div class="ttname"><a href="structer__stringarray__t.html">er_stringarray_t</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
